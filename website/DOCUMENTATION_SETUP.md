# Documentation Setup Summary

This document summarizes the automated documentation architecture setup for Brebaje.

## Phase 2: Generation and Build ✅

### TypeDoc Configuration

- **File**: `typedoc.json`
- **Entry Points**: Only `apps/backend/src/main.ts` (CLI removed)
- **Output**: `docs/api/` (Markdown format)
- **Plugin**: `typedoc-plugin-markdown` enabled
- **Settings**:
  - No README generation (`readme: "none"`)
  - Entry files named `index.md`
  - Public path: `/api/`

### Docusaurus Configuration

- **File**: `website/docusaurus.config.js`
- **Docs Path**: `../docs` (relative to website directory)
- **KaTeX Support**: Enabled via `remark-math` and `rehype-katex`
- **Base URL**: Configured for Read the Docs deployment

### Sidebar Configuration

- **File**: `website/sidebars.js`
- **Structure**: Organized by Diataxis model:
  - Get Started (autogenerated from `docs/get-started/`)
  - Tutorials (autogenerated from `docs/tutorials/`)
  - API Reference (organized by domain modules)
  - Security & Operations (autogenerated from `docs/security/`)
- **API Organization**: Domain-based (Auth, Ceremonies, Circuits, etc.) similar to relay.dev

## Phase 3: Deployment Strategy ✅

### GitHub Actions Workflow

- **File**: `.github/workflows/docs.yml`
- **Triggers**: Push to `main` branch (filtered by relevant paths)
- **Steps**:
  1. Install dependencies
  2. Build backend (for TypeDoc)
  3. Generate TypeDoc API documentation
  4. Build Docusaurus static site
  5. Deploy to Read the Docs via webhook

### Deployment Configuration

- **Webhook Secret**: `RTD_WEBHOOK_URL` (must be set in GitHub secrets)
- **Build Artifact**: `docusaurus-build.tar.gz` (created but not uploaded)
- **Error Handling**: Graceful handling if webhook URL not configured

## File Structure

```
brebaje/
├── typedoc.json              # TypeDoc configuration
├── website/
│   ├── docusaurus.config.js   # Docusaurus configuration
│   ├── sidebars.js            # Sidebar navigation
│   ├── package.json           # Website dependencies
│   ├── src/                   # React components
│   └── static/                # Static assets
├── docs/
│   ├── api/                   # Auto-generated API docs
│   ├── get-started/           # Manual documentation
│   ├── tutorials/             # Manual documentation
│   └── security/              # Manual documentation
└── .github/workflows/
    └── docs.yml               # CI/CD workflow
```

## Usage

### Local Development

```bash
# Generate API documentation
pnpm docs

# Start Docusaurus dev server
pnpm docs:start

# Build documentation site
pnpm docs:build

# Serve built site
pnpm docs:serve
```

### API Documentation Organization

The API documentation is organized by domain modules (similar to relay.dev):

- **Authentication**: Auth module
- **Ceremonies**: Ceremony management
- **Circuits**: Circuit definitions
- **Contributions**: Contribution tracking
- **Participants**: Participant management
- **Projects**: Project organization
- **Users**: User management
- **Storage**: S3 storage operations
- **Virtual Machines**: EC2 instance management
- **Health**: Health checks
- **Database**: Database utilities
- **Types**: Type definitions
- **Utilities**: Helper functions
- **Application**: App configuration

Each module contains:
- Controllers (REST endpoints)
- Services (Business logic)
- Models (Database entities)
- DTOs (Data Transfer Objects)
- Guards (Authentication/Authorization)

## Mathematical Notation

LaTeX notation is supported for mathematical expressions. Use:

- Inline: `$e(g_1, g_2) = g_T$`
- Block: `$$\mathbb{G}_1 \times \mathbb{G}_2 \rightarrow \mathbb{G}_T$$`

## Next Steps

1. **Set Webhook Secret**: Add `RTD_WEBHOOK_URL` to GitHub repository secrets
2. **Configure Read the Docs**: Set up the webhook endpoint in Read the Docs
3. **Add Content**: Create manual documentation in:
   - `docs/get-started/`
   - `docs/tutorials/`
   - `docs/security/`
4. **Customize**: Update branding, colors, and homepage in `website/`

## Notes

- API documentation is automatically generated - do not edit files in `docs/api/` manually
- Manual documentation should be placed in the appropriate directories
- The sidebar automatically reflects changes to the documentation structure
- No generic "README" or "index" labels in navigation - content is organized by domain
