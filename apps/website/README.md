# Brebaje Website

This directory contains the Docusaurus-based documentation website for Brebaje.

## Overview

The website automatically generates API documentation from the backend source code using TypeDoc and integrates it seamlessly with hand-written documentation.

## Features

- ðŸ“š **Auto-generated API Docs** - TypeDoc extracts documentation from backend code
- ðŸŽ¨ **Modern UI** - Built with Docusaurus
- ðŸŒ“ **Dark Mode** - Supports light and dark themes
- ðŸ” **Search** - Full-text search across all documentation
- ðŸ“Š **Mermaid Diagrams** - Support for protocol diagrams
- â™»ï¸ **Hot Reload** - Instant updates during development

## Tech Stack

- **Docusaurus** - Documentation framework
- **TypeDoc** - API documentation generator
- **docusaurus-plugin-typedoc** - Integration plugin
- **typedoc-plugin-markdown** - Markdown output for TypeDoc
- **typedoc-plugin-mermaid** - Mermaid diagram support

## Development

### Prerequisites

- Node.js >= 22.17.1
- pnpm >= 10.0.0

### Installation

```bash
# From the root of the monorepo
pnpm install

# Or from this directory
cd apps/website
pnpm install
```

### Development Server

Start the development server with hot reload:

```bash
pnpm start
```

The website will be available at http://localhost:3000

### Building

Build the static website:

```bash
pnpm build
```

This will:

1. Generate API documentation from backend source code using TypeDoc
2. Build the Docusaurus site
3. Output static files to `build/`

### Local Preview

Preview the production build locally:

```bash
pnpm serve
```

## TypeDoc Configuration

API documentation is automatically generated from the backend source code. The configuration is in `docusaurus.config.js`:

### Entry Points

- `../backend/src/app.module.ts` - Main backend module (expands to all imported modules)

### Exclusions

Test files and build artifacts are automatically excluded:

- `**/*.spec.ts`
- `**/*.test.ts`
- `**/node_modules/**`
- `**/dist/**`
- `**/build/**`

### Output

Generated markdown files are placed in `docs/api/` and are automatically integrated into the sidebar.

## Directory Structure

```
apps/website/
â”œâ”€â”€ docs/                    # Documentation content
â”‚   â”œâ”€â”€ intro.md            # Introduction page
â”‚   â”œâ”€â”€ setup.md            # Setup guide
â”‚   â”œâ”€â”€ contributing.md     # Contributing guide
â”‚   â”œâ”€â”€ developer-guide.md  # Developer guide
â”‚   â”œâ”€â”€ tsdoc-guide.md      # TSDoc guide
â”‚   â””â”€â”€ api/                # Auto-generated API docs (TypeDoc output)
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ custom.css      # Custom styles
â”‚   â””â”€â”€ pages/
â”‚       â””â”€â”€ index.tsx       # Homepage (redirects to intro)
â”œâ”€â”€ static/
â”‚   â””â”€â”€ img/                # Static images
â”œâ”€â”€ docusaurus.config.js    # Main configuration
â”œâ”€â”€ sidebars.js             # Sidebar structure
â””â”€â”€ package.json
```

## Documentation Content

### Hand-written Docs

Located in `docs/` directory:

- `intro.md` - Project introduction
- `setup.md` - Setup instructions
- `contributing.md` - Contribution guidelines
- `developer-guide.md` - Development best practices
- `tsdoc-guide.md` - Documentation standards

### Auto-generated API Docs

Located in `docs/api/` (generated by TypeDoc):

- Backend modules (auth, ceremonies, circuits, etc.)
- Controllers, services, DTOs, models
- Utilities and helpers

## Deployment

The website is automatically built and deployed via GitHub Actions when changes are pushed to the `main` branch.

### GitHub Actions Workflow

The `.github/workflows/deploy-docs.yml` workflow:

1. Installs dependencies using pnpm
2. Builds the website (including TypeDoc generation)
3. Deploys to GitHub Pages

### Manual Deployment

To deploy manually:

```bash
# Build the site
pnpm build

# Deploy to GitHub Pages
GIT_USER=<Your GitHub username> pnpm deploy
```

## Strict Mode

The build fails if TypeDoc encounters errors:

- Invalid symbol links
- Missing documentation for public APIs
- Type errors during generation

This ensures documentation quality and completeness.

## Customization

### Theme

Customize colors and styles in `src/css/custom.css`.

### Configuration

Main configuration is in `docusaurus.config.js`:

- Site metadata
- Navigation
- Plugins
- Theme settings

### Sidebar

Sidebar structure is defined in `sidebars.js`. The API section is auto-generated from TypeDoc output.

## Troubleshooting

### TypeDoc Generation Fails

1. Check that backend TypeScript compiles: `cd ../backend && pnpm build`
2. Verify TSDoc syntax in backend code
3. Check TypeDoc configuration in `docusaurus.config.js`

### Build Fails

1. Clear Docusaurus cache: `pnpm clear`
2. Delete `node_modules` and reinstall: `rm -rf node_modules && pnpm install`
3. Check for broken links: Review `onBrokenLinks` errors in build output

### Hot Reload Not Working

1. Stop the dev server
2. Clear cache: `pnpm clear`
3. Restart: `pnpm start`

## Contributing

When adding new backend modules or APIs:

1. Add proper TSDoc comments (see `docs/tsdoc-guide.md`)
2. Documentation will be automatically generated on next build
3. No manual documentation needed for API reference

When adding hand-written documentation:

1. Add markdown files to `docs/`
2. Update `sidebars.js` if needed
3. Test locally with `pnpm start`

## License

See the main project LICENSE file.
